# 보배드림 크롤러

## 개요

보배드림 커뮤니티의 게시글을 크롤링 하여 S3에 적재합니다.

## 디렉터리 구조

```
📦bobaedream
 ┣ 📜.gitignore
 ┣ 📜.python-version
 ┣ 📜Dockerfile
 ┣ 📜README.md
 ┣ 📜main.py                       # main 파일
 ┣ 📜poetry.lock
 ┣ 📜post_extractor.py             # 단일 URL에 대한 게시글 추출			
 ┣ 📜post_info_list_extractor.py   # 특정 키워드에 대한 게시글 목록 반환
 ┣ 📜pyproject.toml
 ┗ 📜test.py                       # 테스트 코드
```

## 이분 탐색 전략

* `post_info_list_extractor.py`에서는 아래 단계를 통해 원하는 기간(예: start_date ~ end_date)에 해당하는 첫 번째 페이지부터 게시글을 수집할 수 있도록 이분 탐색을 수행합니다.
* 게시글들은 작성 날짜에 대해 내림차순으로 정렬되어 있으며 첫 페이지에는 가장 최신 날짜의 게시글들이 존재합니다.
* 게시글 목록은 start_date까지만 조회됩니다.

#### 페이지 범위 확장

* 초기에는 페이지 전체 범위를 알 수 없으므로, 500단위(기본값)씩 범위를 넓혀가며 해당 구간 안에 우리가 찾는 게시글이 포함되어 있는지 확인합니다.

#### 구간 내 이분 탐색

* 각 구간(start ~ end) 내에서 중앙 페이지(mid)를 확인해, 그 페이지의 가장 오래된 게시글 날짜와 end_date를 비교합니다.
  * end_date보다 같거나 오래된 경우 좌측을 탐색합니다.
  * 반대의 경우 우측을 탐색합니다.
* start와 end가 뒤집히면 탐색을 종료합니다.

#### 예외 처리

* 페이지 구조가 깨진 경우 주변 페이지(왼쪽 또는 오른쪽)를 탐색하며 유효한 페이지를 찾습니다.
  * 양쪽 모두에 대해 유효한 페이지를 찾은 뒤, 마찬가지로 end_date와의 비교를 위해 왼쪽 페이지에 대한 게시글 목록을 파싱합니다.
  * 해당 목록의 가장 오래된 게시글 날짜가 end_date보다 같거나 오래된 경우 좌측을 탐색합니다.
  * 반대의 경우 우측을 탐색합니다.

#### 결과

* 이분 탐색으로 찾은 시작 페이지부터 게시글 목록을 순회하며 원하는 게시글을 크롤링합니다.
